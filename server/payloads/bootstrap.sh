export PS1=''; err_report() { json=$(printf '{"session_id": "%s", "task": "%s", "stdout": "", "stderr": "%s", "returncode": %d}\n' "$SESSION_ID", "$TASK", "Error on line $1","1"); echo $json 1>&2; exit 1; }; trap 'err_report $LINENO' ERR; decode_payload() { command=$(echo "$1" | base64 -d); output=$(eval "$command" | base64 -w0 2>&1); ret=$?; json=$(printf '{"session_id": "%s", "task": "%s", "stdout": "%s", "stderr": "", "returncode": %d}\n' "$SESSION_ID", "$TASK", "$(echo -n "$output")" "$ret"); echo $json 1>&2;}